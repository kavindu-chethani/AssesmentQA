"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.unRegister = exports.register = exports.isLegacyTest = void 0;
const get_url_1 = __importDefault(require("./get-url"));
const get_code_1 = __importDefault(require("./get-code"));
const content_types_1 = __importDefault(require("../assets/content-types"));
function isLegacyTest(test) {
    return !!test.isLegacy;
}
exports.isLegacyTest = isLegacyTest;
function register(proxy, tests, proxyless) {
    const routes = [];
    tests.forEach(test => {
        if (isLegacyTest(test))
            return;
        test.clientScripts.forEach((script) => {
            const route = (0, get_url_1.default)(script);
            proxy.GET(route, {
                content: (0, get_code_1.default)(script, proxyless),
                contentType: content_types_1.default.javascript,
            });
            routes.push(route);
        });
    });
    return routes;
}
exports.register = register;
function unRegister(proxy, routes) {
    routes.forEach(route => {
        proxy.unRegisterRoute(route, 'GET');
    });
}
exports.unRegister = unRegister;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jdXN0b20tY2xpZW50LXNjcmlwdHMvcm91dGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSx3REFBaUQ7QUFDakQsMERBQW1EO0FBQ25ELDRFQUFvRDtBQWVwRCxTQUFnQixZQUFZLENBQUUsSUFBYztJQUN4QyxPQUFPLENBQUMsQ0FBRSxJQUFtQixDQUFDLFFBQVEsQ0FBQztBQUMzQyxDQUFDO0FBRkQsb0NBRUM7QUFFRCxTQUFnQixRQUFRLENBQUUsS0FBWSxFQUFFLEtBQWEsRUFBRSxTQUFrQjtJQUNyRSxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUM7SUFFNUIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNqQixJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUM7WUFDbEIsT0FBTztRQUVYLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBd0IsRUFBRSxFQUFFO1lBQ3BELE1BQU0sS0FBSyxHQUFHLElBQUEsaUJBQXdCLEVBQUMsTUFBc0IsQ0FBQyxDQUFDO1lBRS9ELEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFO2dCQUNiLE9BQU8sRUFBTSxJQUFBLGtCQUF5QixFQUFDLE1BQXNCLEVBQUUsU0FBUyxDQUFDO2dCQUN6RSxXQUFXLEVBQUUsdUJBQWEsQ0FBQyxVQUFVO2FBQ3hDLENBQUMsQ0FBQztZQUVILE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUM7QUFwQkQsNEJBb0JDO0FBRUQsU0FBZ0IsVUFBVSxDQUFFLEtBQVksRUFBRSxNQUFnQjtJQUN0RCxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ25CLEtBQUssQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUpELGdDQUlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGdldEN1c3RvbUNsaWVudFNjcmlwdFVybCBmcm9tICcuL2dldC11cmwnO1xuaW1wb3J0IGdldEN1c3RvbUNsaWVudFNjcmlwdENvZGUgZnJvbSAnLi9nZXQtY29kZSc7XG5pbXBvcnQgQ09OVEVOVF9UWVBFUyBmcm9tICcuLi9hc3NldHMvY29udGVudC10eXBlcyc7XG5pbXBvcnQgQ2xpZW50U2NyaXB0IGZyb20gJy4vY2xpZW50LXNjcmlwdCc7XG5pbXBvcnQgeyBQcm94eSB9IGZyb20gJ3Rlc3RjYWZlLWhhbW1lcmhlYWQnO1xuaW1wb3J0IENsaWVudFNjcmlwdEluaXQgZnJvbSAnLi9jbGllbnQtc2NyaXB0LWluaXQnO1xuXG5pbnRlcmZhY2UgVGVzdCB7XG4gICAgY2xpZW50U2NyaXB0czogQ2xpZW50U2NyaXB0SW5pdFtdO1xufVxuXG5pbnRlcmZhY2UgTGVnYWN5VGVzdCB7XG4gICAgaXNMZWdhY3k6IGJvb2xlYW47XG59XG5cbnR5cGUgVGVzdEl0ZW0gPSBUZXN0IHwgTGVnYWN5VGVzdDtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzTGVnYWN5VGVzdCAodGVzdDogVGVzdEl0ZW0pOiB0ZXN0IGlzIExlZ2FjeVRlc3Qge1xuICAgIHJldHVybiAhISh0ZXN0IGFzIExlZ2FjeVRlc3QpLmlzTGVnYWN5O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXIgKHByb3h5OiBQcm94eSwgdGVzdHM6IFRlc3RbXSwgcHJveHlsZXNzOiBib29sZWFuKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHJvdXRlczogc3RyaW5nW10gPSBbXTtcblxuICAgIHRlc3RzLmZvckVhY2godGVzdCA9PiB7XG4gICAgICAgIGlmIChpc0xlZ2FjeVRlc3QodGVzdCkpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgdGVzdC5jbGllbnRTY3JpcHRzLmZvckVhY2goKHNjcmlwdDogQ2xpZW50U2NyaXB0SW5pdCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgcm91dGUgPSBnZXRDdXN0b21DbGllbnRTY3JpcHRVcmwoc2NyaXB0IGFzIENsaWVudFNjcmlwdCk7XG5cbiAgICAgICAgICAgIHByb3h5LkdFVChyb3V0ZSwge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICAgICBnZXRDdXN0b21DbGllbnRTY3JpcHRDb2RlKHNjcmlwdCBhcyBDbGllbnRTY3JpcHQsIHByb3h5bGVzcyksXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IENPTlRFTlRfVFlQRVMuamF2YXNjcmlwdCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByb3V0ZXMucHVzaChyb3V0ZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJvdXRlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuUmVnaXN0ZXIgKHByb3h5OiBQcm94eSwgcm91dGVzOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgIHJvdXRlcy5mb3JFYWNoKHJvdXRlID0+IHtcbiAgICAgICAgcHJveHkudW5SZWdpc3RlclJvdXRlKHJvdXRlLCAnR0VUJyk7XG4gICAgfSk7XG59XG4iXX0=